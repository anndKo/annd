<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>T·∫°o S∆° ƒê·ªì C√¢y</title>
<style>
    body { font-family: Arial; margin: 20px; }
    #tree-container {
        width: 100%;
        height: 600px;
        border: 1px solid #aaa;
        overflow: auto;
    }
    textarea {
        width: 100%;
        height: 150px;
    }
    button { margin-top: 10px; padding: 8px 14px; }
</style>
</head>
<body>

<h2>üå≥ T·∫°o S∆° ƒê·ªì C√¢y</h2>

<p>Nh·∫≠p c·∫•u tr√∫c c√¢y theo d·∫°ng JSON:</p>
<textarea id="jsonInput">{
  "name": "Gia ƒë√¨nh",
  "children": [
    {
      "name": "Ba",
      "children": [
        { "name": "Con A" },
        { "name": "Con B" }
      ]
    },
    {
      "name": "M·∫π",
      "children": [
        { "name": "Con C" }
      ]
    }
  ]
}</textarea>

<button onclick="renderTree()">V·∫Ω s∆° ƒë·ªì</button>

<div id="tree-container"></div>

<!-- Th∆∞ vi·ªán D3.js -->
<script src="https://d3js.org/d3.v7.min.js"></script>

<script>
function renderTree() {
    document.getElementById("tree-container").innerHTML = ""; 

    let data;
    try {
        data = JSON.parse(document.getElementById("jsonInput").value);
    } catch (e) {
        alert("JSON kh√¥ng h·ª£p l·ªá!");
        return;
    }

    const width = 1000, height = 800;
    const svg = d3.select("#tree-container")
                  .append("svg")
                  .attr("width", width)
                  .attr("height", height)
                  .append("g")
                  .attr("transform", "translate(40,0)");

    const root = d3.hierarchy(data);
    const treeLayout = d3.tree().size([height - 50, width - 200]);
    treeLayout(root);

    // N·ªëi
    svg.selectAll("path")
        .data(root.links())
        .enter()
        .append("path")
        .attr("d", d3.linkHorizontal()
                      .x(d => d.y)
                      .y(d => d.x))
        .attr("fill", "none")
        .attr("stroke", "#555");

    // Node
    const nodes = svg.selectAll("g.node")
        .data(root.descendants())
        .enter()
        .append("g")
        .attr("transform", d => `translate(${d.y},${d.x})`);

    nodes.append("circle")
         .attr("r", 18)
         .attr("fill", "#4CAF50");

    nodes.append("text")
         .attr("dy", 5)
         .attr("x", d => d.children ? -25 : 25)
         .style("text-anchor", d => d.children ? "end" : "start")
         .text(d => d.data.name);
}
</script>

</body>
</html>
