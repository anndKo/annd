<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<title>Game Bắn tàu</title>

<style>
body { 
    font-family: Arial; 
    padding: 20px; 
    background:#f2f2f2; 
    
}

h1 {
    text-align:center;
    font-size:26px;
    margin-bottom:10px;
}

#helpBtn {
    position: fixed; 
    top: 15px; 
    right: 15px;
    padding: 10px 18px; 
    background: #ff9800; 
    color: white;
    border: none; 
    border-radius: 8px; 
    font-size: 16px; 
    cursor: pointer;
    z-index: 11000;
}

#helpOverlay {
    position: fixed; 
    top: 0; 
    left: 0;
    width: 100%; 
    height: 100%; 
    background: rgba(0,0,0,0.8);
    display: none; 
    justify-content: center; 
    align-items: center;
    flex-direction: column; 
    z-index: 12000;
}

#helpOverlay video { 
    max-width: 90%; 
    max-height: 80%; 
    border-radius: 12px; 
}

#closeHelp {
    margin-top: 20px; 
    padding: 12px 20px; 
    background: #e53935;
    color: white; 
    border: none; 
    border-radius: 8px; 
    font-size: 18px; 
    cursor: pointer;
}

/* ==== BẢNG 9×7 ==== */
.board{
    display: grid;
    grid-template-columns: repeat(9, 1fr);   /* 9 CỘT */
    grid-template-rows: repeat(7, 1fr);      /* 7 HÀNG */
    gap: 5px;
    width: 90vw;
    max-width: 500px;
    aspect-ratio: 9 / 7; /* giữ đúng tỉ lệ */
    background: #caa98a;
    padding: 10px;
    border-radius: 10px;
    margin: 0 auto;
     width: calc(90vw - 20px); /* trừ padding */
}

.cell{
    width: 100%; 
    height: 100%;
    border-radius: 6px;
    display: flex; 
    justify-content: center; 
    align-items: center;
    font-weight: 700; 
    color: white; 
    cursor: pointer;
}

.covered{ cursor:pointer; }
.hit{ background:black !important; }
.miss{ color:white !important; font-weight:bold; }
.preview-ok{ background:#4caf50 !important; }
.preview-bad{ background:#e53935 !important; }
.ship-cell{}

/* Bảng đỏ */
#redBoard .covered { background:#c62828 !important; }
#redBoard .hit { background:black !important; }
#redBoard .miss { background:#ffcdd2 !important; color:red !important; }
#redBoard .ship-cell { background:#b71c1c !important; }

/* Bảng xanh */
#blueBoard .covered { background:#1565c0 !important; }
#blueBoard .hit { background:black !important; }
#blueBoard .miss { background:#bbdefb !important; color:blue !important; }
#blueBoard .ship-cell { background:#0d47a1 !important; }

/* palette */
.palette { 
    display:flex; 
    flex-direction:row; 
    justify-content:center; 
    gap:14px; 
    white-space:nowrap; 
    overflow:hidden; 
    width:100%; 
}

.ship { 
    display:flex; 
    gap:4px; 
    flex-shrink:1; 
    min-width:0; 
}

.ship-block {
    aspect-ratio: 1;
    width: 11vw;
    max-width: 50px;
    background:#1565c0;
    border-radius:5px;
}

.hidden { display:none; }

.rotate-btn {
    padding:6px 10px; 
    background:#1565c0; 
    color:white;
    border:none; 
    border-radius:6px; 
    cursor:pointer; 
    margin-top:5px;
}

#status{ 
    text-align:center; 
    font-size:18px; 
    margin:15px 0; 
    font-weight:700; 
}

.blur-board {
    opacity: 0.35;
    filter: blur(1.5px);
    transition: 0.4s;
}

.bullet{
    position:absolute;
    width: 14px;
    height: 14px;
    background: yellow;
    border-radius: 50%;
    pointer-events:none;
    z-index:9999;
    transition: transform 0.45s linear;
}

.fire-hit { 
    box-shadow:0 0 12px 5px orange, 0 0 20px 10px red;
    animation: firePulse 0.8s ease-out forwards; 
}

@keyframes firePulse {
    0% { box-shadow:0 0 5px 2px orange; }
    100%{ box-shadow:0 0 22px 12px red; }
}

.ship-dead-purple { 
    background:#6a1b9a !important; 
    border-radius:4px !important; 
}

.shake { 
    animation: shakeAnim 0.4s; 
}

@keyframes shakeAnim {
    0%{transform:translate(0);}
    20%{transform:translate(-5px,0);}
    40%{transform:translate(5px,0);}
    60%{transform:translate(-5px,0);}
    80%{transform:translate(5px,0);}
    100%{transform:translate(0);}
}

#winnerOverlay {
    position:fixed; 
    top:0; 
    left:0; 
    width:100%; 
    height:100%;
    background:rgba(0,0,0,0.75); 
    display:none;
    justify-content:center; 
    align-items:center; 
    flex-direction:column;
    color:white; 
    font-size:28px; 
    font-weight:bold; 
    z-index:10000;
}

#winnerOverlay img { 
    max-width:300px; 
    margin-top:20px; 
    border-radius:12px; 
}

#winnerOverlay button {
    margin-top:30px; 
    padding:12px 25px; 
    font-size:18px;
    border:none; 
    border-radius:8px; 
    background:#4caf50; 
    color:white;
    cursor:pointer;
}
</style>
</head>

<body>
    
    <audio id="placeSound" src="an.mp3" preload="auto"></audio>

  <audio id="hitSound" src="bum.mp3" preload="auto"></audio>
<audio id="missSound" src="xoet.mp3" preload="auto"></audio>
<audio id="winSound" src="reoho.mp3" preload="auto"></audio>

<button id="hideHelpBtn" onclick="hideHelpBtnFunction()" 
style="position: fixed; top: 15px; right: 130px;
padding: 10px 18px; background:#c52525; color:white;
border:none; border-radius:8px; font-size:16px; cursor:pointer; z-index:11000;font-weight: 600;">
X
</button>

<button id="helpBtn" onclick="showHelp()">Hướng dẫn</button>

<!-- Overlay -->
<div id="helpOverlay">
<video id="helpVideo" controls>
<source src="bắn tàu.mp4" type="video/mp4">
</video>
<button id="closeHelp" onclick="closeHelp()">Đóng</button>
</div>

<h1>Bắn tàu 2 Người</h1>

<!-- ĐẶT TÀU -->
<div id="placeArea">
    <h3 id="placeLabel" style="text-align:center;color:red;font-size:36px;">Người ĐỎ đặt tàu</h3>

    <div class="palette" id="palette"></div>

    <div style="text-align:center">
        <button class="rotate-btn" onclick="rotateShip()" style="margin-top:10px;font-size:20px;background-color:#4caf50;">Xoay tàu</button>
    </div>

    <h3 style="text-align:center">Lưới đặt</h3>
    <div id="placeBoard" class="board"></div>

    <div style="text-align:center;margin-top:15px">
        <button onclick="confirmPlacement()" style="padding:10px 20px;border:none;background:#4caf50;color:white;border-radius:8px;font-size:16px;cursor:pointer">
            Xác nhận đặt
        </button>
        <button onclick="resetPlacement()" style="padding:10px 20px;border:none;background:#e53935;color:white;border-radius:8px;font-size:16px;cursor:pointer;margin-left:10px">
            Đặt lại
        </button>
    </div>
</div>

<!-- CHƠI GAME -->
<div id="playArea" class="hidden">

    <div style="text-align:center; margin-bottom:15px;">
        <button onclick="restartGame()" 
            style="padding:10px 20px;border:none;background:#9c27b0;color:white;border-radius:8px;font-size:16px;cursor:pointer;">
            Chơi lại từ đầu
        </button>
    </div>

    <div id="playBoardsWrapper">
        <div class="boardWrapper"><div id="redBoard" class="board"></div></div>

        <div id="status"></div>

        <div class="boardWrapper"><div id="blueBoard" class="board"></div></div>
    </div>
</div>

<div id="winnerOverlay">
    <div id="winnerText">Người ĐỎ thắng!</div>
    <img src="winner.png" alt="win">
    <button onclick="confirmWinner()">Xác nhận</button>
</div>
<script>
 const _0x574988=_0x3eb4;(function(_0x365f30,_0x3f6ba4){const _0x598a9e=_0x3eb4,_0xd2788=_0x365f30();while(!![]){try{const _0x22e698=parseInt(_0x598a9e(0xea))/0x1+parseInt(_0x598a9e(0xb2))/0x2*(-parseInt(_0x598a9e(0xee))/0x3)+parseInt(_0x598a9e(0xe2))/0x4+-parseInt(_0x598a9e(0xd2))/0x5*(-parseInt(_0x598a9e(0xdd))/0x6)+-parseInt(_0x598a9e(0xef))/0x7*(parseInt(_0x598a9e(0xbd))/0x8)+-parseInt(_0x598a9e(0x10c))/0x9+-parseInt(_0x598a9e(0xdc))/0xa*(-parseInt(_0x598a9e(0xc3))/0xb);if(_0x22e698===_0x3f6ba4)break;else _0xd2788['push'](_0xd2788['shift']());}catch(_0x1324e7){_0xd2788['push'](_0xd2788['shift']());}}}(_0xca60,0x19d35),document[_0x574988(0xd4)]('gesturestart',function(_0x12a7eb){const _0x8c4d9a=_0x574988;_0x12a7eb[_0x8c4d9a(0xf5)]();}),window[_0x574988(0xd4)](_0x574988(0xa1),function(_0x40671c){const _0x34540b=_0x574988;if(_0x40671c[_0x34540b(0xbf)])_0x40671c[_0x34540b(0xf5)]();},{'passive':![]}),window[_0x574988(0xd4)](_0x574988(0xdb),function(_0x484085){const _0x5d4c71=_0x574988;if(_0x484085[_0x5d4c71(0xad)]!==undefined&&_0x484085[_0x5d4c71(0xad)]!==0x1)_0x484085[_0x5d4c71(0xf5)]();},{'passive':![]}));let lastTouchEnd=0x0;document[_0x574988(0xd4)](_0x574988(0x10e),function(_0x19a519){const _0x1bc4c4=_0x574988;let _0x5d1e91=new Date()[_0x1bc4c4(0xb4)]();_0x5d1e91-lastTouchEnd<=0x12c&&_0x19a519[_0x1bc4c4(0xf5)](),lastTouchEnd=_0x5d1e91;},![]);const ROWS=0x7,COLS=0x9,SHIPS=[0x4,0x3,0x2,0x1];let placingPlayer=_0x574988(0xcb),rotateDir='h',currentTurn='red',boards={'red':emptyBoard(),'blue':emptyBoard()},shots={'red':emptyBoard(),'blue':emptyBoard()},draggingShipSize=null,playerShips={'red':[],'blue':[]},standbyBullet=null,audioUnlocked=![];function unlockAudio(){const _0x147bdf=_0x574988;if(audioUnlocked)return;audioUnlocked=!![],[hitSound,missSound,winSound,placeSound][_0x147bdf(0xc9)](_0x1242bd=>{const _0x4d1b2c=_0x147bdf;_0x1242bd['pause'](),_0x1242bd[_0x4d1b2c(0x100)]=0x0;}),document[_0x147bdf(0xca)](_0x147bdf(0xa2),unlockAudio),document[_0x147bdf(0xca)]('click',unlockAudio);}document[_0x574988(0xd4)](_0x574988(0xa2),unlockAudio,{'passive':!![]}),document[_0x574988(0xd4)](_0x574988(0xb0),unlockAudio);function emptyBoard(){const _0x4744fd=_0x574988;return Array[_0x4744fd(0xd1)]({'length':ROWS},()=>Array(COLS)[_0x4744fd(0xde)](null));}function elem(_0x3d2426){return document['getElementById'](_0x3d2426);}const placeBoardEl=elem('placeBoard');buildBoard(placeBoardEl,onPlaceCellEnter,onPlaceCellClick);function buildBoard(_0x3162fa,_0x2a87b7,_0x5c7c49){const _0x2b7336=_0x574988;_0x3162fa[_0x2b7336(0xd8)]='';for(let _0x3ba3a9=0x0;_0x3ba3a9<ROWS;_0x3ba3a9++){for(let _0x29c446=0x0;_0x29c446<COLS;_0x29c446++){let _0x3e31ab=document[_0x2b7336(0xd0)](_0x2b7336(0x104));_0x3e31ab[_0x2b7336(0xc0)]=_0x2b7336(0xa5),_0x3e31ab[_0x2b7336(0x107)]['r']=_0x3ba3a9,_0x3e31ab[_0x2b7336(0x107)]['c']=_0x29c446;if(_0x2a87b7)_0x3e31ab[_0x2b7336(0xd4)](_0x2b7336(0xbe),_0x2a87b7);if(_0x5c7c49)_0x3e31ab[_0x2b7336(0xd4)]('click',_0x5c7c49);_0x3162fa['appendChild'](_0x3e31ab);}}}function buildPalette(){const _0x480916=_0x574988;let _0x559c86=elem(_0x480916(0xd5));_0x559c86['innerHTML']='',SHIPS[_0x480916(0xc9)](_0x1d7386=>{const _0x702fc9=_0x480916;let _0x2cbdec=document[_0x702fc9(0xd0)](_0x702fc9(0x104));_0x2cbdec[_0x702fc9(0xc0)]=_0x702fc9(0xf2),_0x2cbdec[_0x702fc9(0x107)]['size']=_0x1d7386,_0x2cbdec[_0x702fc9(0x107)]['placed']=_0x702fc9(0xf4);for(let _0x2bd406=0x0;_0x2bd406<_0x1d7386;_0x2bd406++){let _0xb3180=document[_0x702fc9(0xd0)](_0x702fc9(0x104));_0xb3180[_0x702fc9(0xc0)]=_0x702fc9(0xe0),_0x2cbdec[_0x702fc9(0xf1)](_0xb3180);}_0x2cbdec['addEventListener']('click',()=>{const _0xb5e267=_0x702fc9;if(_0x2cbdec[_0xb5e267(0x107)]['placed']==='true')return;draggingShipSize=_0x1d7386,document[_0xb5e267(0xf9)](_0xb5e267(0xbc))[_0xb5e267(0xc9)](_0x36c97c=>{const _0x130224=_0xb5e267;if(_0x36c97c[_0x130224(0x107)][_0x130224(0x106)]===_0x130224(0xf4))_0x36c97c['style'][_0x130224(0xe1)]='1';}),_0x2cbdec[_0xb5e267(0xa0)][_0xb5e267(0xe1)]=_0xb5e267(0xf8);}),_0x559c86[_0x702fc9(0xf1)](_0x2cbdec);});}buildPalette();function rotateShip(){rotateDir=rotateDir==='h'?'v':'h';}function onPlaceCellEnter(){const _0x5ec6c9=_0x574988;if(!draggingShipSize)return;clearPreview();const _0x2a6578=parseInt(this['dataset']['r']),_0x3230da=parseInt(this[_0x5ec6c9(0x107)]['c']),_0x147972=canPlaceShip(placingPlayer,_0x2a6578,_0x3230da,draggingShipSize),_0x38c208=getShipCells(_0x2a6578,_0x3230da,draggingShipSize);_0x38c208[_0x5ec6c9(0xc9)](_0x2e3cde=>{const _0x2713e7=_0x5ec6c9;if(_0x2e3cde['r']<0x0||_0x2e3cde['c']<0x0||_0x2e3cde['r']>=ROWS||_0x2e3cde['c']>=COLS)return;let _0x26bbe3=_0x2e3cde['r']*COLS+_0x2e3cde['c'],_0x362696=placeBoardEl[_0x2713e7(0xc8)][_0x26bbe3];if(_0x362696)_0x362696[_0x2713e7(0x10d)][_0x2713e7(0x10b)](_0x147972?_0x2713e7(0xc6):_0x2713e7(0xff));});}function _0x3eb4(_0x416601,_0x3462b1){const _0xca60dc=_0xca60();return _0x3eb4=function(_0x3eb412,_0x22cbfb){_0x3eb412=_0x3eb412-0xa0;let _0x28598d=_0xca60dc[_0x3eb412];return _0x28598d;},_0x3eb4(_0x416601,_0x3462b1);}function onPlaceCellClick(){const _0x1e2ae1=_0x574988;if(!draggingShipSize)return;const _0xcbe6dd=parseInt(this['dataset']['r']),_0x340655=parseInt(this[_0x1e2ae1(0x107)]['c']);if(!canPlaceShip(placingPlayer,_0xcbe6dd,_0x340655,draggingShipSize)){alert(_0x1e2ae1(0xb6));return;}placeShip(placingPlayer,_0xcbe6dd,_0x340655,draggingShipSize),placeSound[_0x1e2ae1(0x100)]=0x0,placeSound[_0x1e2ae1(0xb5)]();const _0x6f9913=[...document[_0x1e2ae1(0xf9)](_0x1e2ae1(0xbc))][_0x1e2ae1(0xa3)](_0x2ab3b4=>parseInt(_0x2ab3b4[_0x1e2ae1(0x107)][_0x1e2ae1(0xa6)])===draggingShipSize);_0x6f9913&&(_0x6f9913[_0x1e2ae1(0x107)]['placed']=_0x1e2ae1(0xfd),_0x6f9913['style']['opacity']=_0x1e2ae1(0xf8),_0x6f9913[_0x1e2ae1(0xa0)][_0x1e2ae1(0xe6)]='none'),draggingShipSize=null,clearPreview(),renderPlaceBoard();}function clearPreview(){const _0x48b8de=_0x574988;[...placeBoardEl[_0x48b8de(0xc8)]][_0x48b8de(0xc9)](_0x4fd383=>_0x4fd383['classList']['remove']('preview-ok',_0x48b8de(0xff)));}function getShipCells(_0x434ad1,_0x4ebbed,_0x5eb754){const _0x47b143=_0x574988;let _0x2dcd32=[];for(let _0x586391=0x0;_0x586391<_0x5eb754;_0x586391++){if(rotateDir==='h')_0x2dcd32[_0x47b143(0xf0)]({'r':_0x434ad1,'c':_0x4ebbed+_0x586391});else _0x2dcd32['push']({'r':_0x434ad1+_0x586391,'c':_0x4ebbed});}return _0x2dcd32;}function canPlaceShip(_0x5894c3,_0x10d856,_0x25e7fc,_0x4e1194){const _0x50edfd=getShipCells(_0x10d856,_0x25e7fc,_0x4e1194);for(let _0x318c43 of _0x50edfd){if(_0x318c43['r']<0x0||_0x318c43['c']<0x0||_0x318c43['r']>=ROWS||_0x318c43['c']>=COLS)return![];if(boards[_0x5894c3][_0x318c43['r']][_0x318c43['c']]!=null)return![];}return!![];}function placeShip(_0x11fcc9,_0x1692e8,_0x33a92b,_0x4cdb11){const _0x5a6043=_0x574988,_0x1652c7=getShipCells(_0x1692e8,_0x33a92b,_0x4cdb11);_0x1652c7[_0x5a6043(0xc9)](_0x51536c=>boards[_0x11fcc9][_0x51536c['r']][_0x51536c['c']]='ship'),playerShips[_0x11fcc9][_0x5a6043(0xf0)](_0x1652c7);}function renderPlaceBoard(){const _0xf5e2fa=_0x574988;for(let _0x546af2=0x0;_0x546af2<ROWS;_0x546af2++){for(let _0x4660cd=0x0;_0x4660cd<COLS;_0x4660cd++){let _0x2b6d13=placeBoardEl['children'][_0x546af2*COLS+_0x4660cd];_0x2b6d13[_0xf5e2fa(0xa0)]['background']=boards[placingPlayer][_0x546af2][_0x4660cd]?'#003049':_0xf5e2fa(0xfa);}}}function countShipsPlaced(_0x304055){const _0x5348ec=_0x574988;let _0x291045=0x0;return document[_0x5348ec(0xf9)](_0x5348ec(0xbc))[_0x5348ec(0xc9)](_0x185f4c=>{const _0x153ac7=_0x5348ec;if(_0x185f4c['dataset'][_0x153ac7(0x106)]===_0x153ac7(0xfd))_0x291045++;}),_0x291045;}function confirmPlacement(){const _0x3058e1=_0x574988;if(countShipsPlaced(placingPlayer)<SHIPS[_0x3058e1(0xb7)]){alert(_0x3058e1(0xfe));return;}placingPlayer===_0x3058e1(0xcb)?(placingPlayer=_0x3058e1(0xb9),elem(_0x3058e1(0x103))[_0x3058e1(0xd8)]='Người\x20<span\x20style=\x27color:blue\x27>XANH</span>\x20đặt\x20tàu',draggingShipSize=null,buildPalette(),renderPlaceBoard()):(elem('helpBtn')[_0x3058e1(0xa0)][_0x3058e1(0xa8)]='none',elem(_0x3058e1(0xe8))['style'][_0x3058e1(0xa8)]='none',startGame());}function startGame(){const _0x33779e=_0x574988;elem(_0x33779e(0x102))[_0x33779e(0x10d)][_0x33779e(0x10b)](_0x33779e(0xeb)),elem(_0x33779e(0xf6))[_0x33779e(0x10d)][_0x33779e(0xd9)](_0x33779e(0xeb)),[_0x33779e(0xcb),_0x33779e(0xb9)][_0x33779e(0xc9)](_0x2041a3=>{const _0x757162=_0x33779e;let _0x3ada0e=elem(_0x2041a3+_0x757162(0x10a));_0x3ada0e[_0x757162(0xd8)]='';for(let _0x36aabc=0x0;_0x36aabc<ROWS;_0x36aabc++){for(let _0x20d823=0x0;_0x20d823<COLS;_0x20d823++){let _0x8472a7=document[_0x757162(0xd0)](_0x757162(0x104));_0x8472a7[_0x757162(0xc0)]=_0x757162(0xba),_0x8472a7['dataset']['r']=_0x36aabc,_0x8472a7[_0x757162(0x107)]['c']=_0x20d823,_0x8472a7[_0x757162(0x107)]['player']=_0x2041a3,_0x8472a7['addEventListener']('click',onShoot),_0x3ada0e[_0x757162(0xf1)](_0x8472a7);}}}),renderPlayBoards(),updateTurnText();}function updateTurnText(){const _0x2cddef=_0x574988;elem(_0x2cddef(0xa7))[_0x2cddef(0xd8)]=currentTurn===_0x2cddef(0xcb)?_0x2cddef(0xe9):_0x2cddef(0xaf),elem(_0x2cddef(0xb8))[_0x2cddef(0x10d)][_0x2cddef(0xd9)](_0x2cddef(0xe5)),elem('blueBoard')[_0x2cddef(0x10d)][_0x2cddef(0xd9)](_0x2cddef(0xe5)),setTimeout(()=>{const _0x296612=_0x2cddef;if(currentTurn===_0x296612(0xcb))elem('redBoard')['classList']['add'](_0x296612(0xe5));else elem(_0x296612(0xd6))[_0x296612(0x10d)][_0x296612(0x10b)]('blur-board');},0x12c),setTimeout(()=>spawnStandbyBullet(currentTurn),0x12c);}function _0xca60(){const _0x3fa0be=['cell\x20covered','flex','.palette\x20.ship','1097984IZKXsF','mouseenter','ctrlKey','className','hit','helpBtn','11wZnfmM','helpOverlay','top','preview-ok','\x20thắng!','children','forEach','removeEventListener','red','ship-dead-purple','miss','width','call','createElement','from','117195LqQuRA','contains','addEventListener','palette','blueBoard','getElementById','innerHTML','remove','getBoundingClientRect','touchmove','2356460jgfBGS','30ONravk','fill','none','ship-block','opacity','339136MYSRAV','offsetHeight','random','blur-board','pointerEvents','left','hideHelpBtn','<span\x20style=\x27color:red\x27>Lượt\x20của\x20ĐỎ</span>','47738EBdodm','hidden','load','originY','263643mdDTTY','7JCexPY','push','appendChild','ship','toUpperCase','false','preventDefault','playArea','Người\x20<span\x20style=\x27color:red\x27>ĐỎ</span>\x20đặt\x20tàu','0.3','querySelectorAll','#8a5a44','floor','originX','true','Bạn\x20phải\x20đặt\x20đủ\x204\x20tàu!','preview-bad','currentTime','height','placeArea','placeLabel','div','bullet','placed','dataset','some','every','Board','add','1390077CmWZaO','classList','touchend','style','wheel','touchstart','find','winnerText','cell','size','status','display','now','player','textContent','60px','scale','shake','<span\x20style=\x27color:blue\x27>Lượt\x20của\x20XANH</span>','click','helpVideo','2IwdepI','winnerOverlay','getTime','play','Không\x20thể\x20đặt\x20tại\x20đây!','length','redBoard','blue'];_0xca60=function(){return _0x3fa0be;};return _0xca60();}function spawnStandbyBullet(_0x52a4f2){const _0x364a35=_0x574988;if(standbyBullet)standbyBullet[_0x364a35(0xd9)]();standbyBullet=document[_0x364a35(0xd0)](_0x364a35(0x104)),standbyBullet[_0x364a35(0xc0)]=_0x364a35(0x105),standbyBullet[_0x364a35(0xa0)][_0x364a35(0xce)]=_0x364a35(0xac),standbyBullet[_0x364a35(0xa0)]['height']=_0x364a35(0xac);const _0x2d917a=Math[_0x364a35(0xfb)](ROWS/0x2)*COLS+Math['floor'](COLS/0x2),_0x50de5e=elem(_0x52a4f2+'Board')[_0x364a35(0xc8)][_0x2d917a][_0x364a35(0xda)](),_0xcaf7a0=_0x50de5e[_0x364a35(0xe7)]+_0x50de5e[_0x364a35(0xce)]/0x2,_0x5c3a13=_0x50de5e[_0x364a35(0xc5)]+_0x50de5e[_0x364a35(0x101)]/0x2;standbyBullet[_0x364a35(0xa0)][_0x364a35(0xe7)]=_0xcaf7a0-0x1e+'px',standbyBullet[_0x364a35(0xa0)]['top']=_0x5c3a13-0x1e+'px',standbyBullet[_0x364a35(0x107)]['originX']=_0xcaf7a0,standbyBullet[_0x364a35(0x107)]['originY']=_0x5c3a13,document['body'][_0x364a35(0xf1)](standbyBullet);}function shootBullet(_0x1fb596){const _0x165272=_0x574988;if(!standbyBullet)return;const _0x2926be=_0x1fb596['getBoundingClientRect'](),_0xcd142b=_0x2926be[_0x165272(0xe7)]+_0x2926be[_0x165272(0xce)]/0x2+window['scrollX'],_0x1ff670=_0x2926be[_0x165272(0xc5)]+_0x2926be['height']/0x2+window['scrollY'],_0x46187e=parseFloat(standbyBullet[_0x165272(0x107)][_0x165272(0xfc)]),_0x53b674=parseFloat(standbyBullet[_0x165272(0x107)][_0x165272(0xed)]);let _0x384146=standbyBullet,_0x1788a7=(_0x46187e+_0xcd142b)/0x2+(Math[_0x165272(0xe4)]()*0xc8-0x64),_0x5ee8b8=_0x53b674-0x96,_0x116adf=0x320,_0x5e2632=performance[_0x165272(0xa9)]();function _0x1532d0(_0x432a67){const _0x1ae688=_0x165272;let _0x983965=(_0x432a67-_0x5e2632)/_0x116adf;if(_0x983965>0x1)_0x983965=0x1;let _0x30f2ca=(0x1-_0x983965)*(0x1-_0x983965)*_0x46187e+0x2*(0x1-_0x983965)*_0x983965*_0x1788a7+_0x983965*_0x983965*_0xcd142b,_0x27c923=(0x1-_0x983965)*(0x1-_0x983965)*_0x53b674+0x2*(0x1-_0x983965)*_0x983965*_0x5ee8b8+_0x983965*_0x983965*_0x1ff670;_0x384146[_0x1ae688(0xa0)][_0x1ae688(0xe7)]=_0x30f2ca-_0x384146['offsetWidth']/0x2+'px',_0x384146[_0x1ae688(0xa0)][_0x1ae688(0xc5)]=_0x27c923-_0x384146[_0x1ae688(0xe3)]/0x2+'px',_0x384146[_0x1ae688(0xa0)][_0x1ae688(0xce)]=0x3c-_0x983965*0x2e+'px',_0x384146['style'][_0x1ae688(0x101)]=0x3c-_0x983965*0x2e+'px';if(_0x983965<0x1)requestAnimationFrame(_0x1532d0);}requestAnimationFrame(_0x1532d0);const _0x2862aa=currentTurn;setTimeout(()=>{const _0x177e96=_0x165272,_0x5a3480=parseInt(_0x1fb596[_0x177e96(0x107)]['r']),_0x25da14=parseInt(_0x1fb596[_0x177e96(0x107)]['c']),_0x4718f7=currentTurn===_0x177e96(0xcb)?_0x177e96(0xb9):'red',_0x1d9940=boards[_0x4718f7][_0x5a3480][_0x25da14]===_0x177e96(0xf2);_0x1d9940?(hitSound[_0x177e96(0xec)](),hitSound[_0x177e96(0x100)]=0x0,hitSound[_0x177e96(0xb5)]()):(missSound[_0x177e96(0xec)](),missSound[_0x177e96(0x100)]=0x0,missSound[_0x177e96(0xb5)]()),oldOnShoot[_0x177e96(0xcf)](_0x1fb596),currentTurn!==_0x2862aa&&setTimeout(()=>spawnStandbyBullet(currentTurn),0x12c);},_0x116adf+0x1e);}const oldOnShoot=function(){const _0x189285=_0x574988,_0x218592=parseInt(this[_0x189285(0x107)]['r']),_0x5b174d=parseInt(this[_0x189285(0x107)]['c']),_0x5b4261=this[_0x189285(0x107)][_0x189285(0xaa)],_0x5c2c48=currentTurn==='red'?'blue':_0x189285(0xcb);if(_0x5b4261!==_0x5c2c48)return;if(shots[_0x5c2c48][_0x218592][_0x5b174d])return;boards[_0x5c2c48][_0x218592][_0x5b174d]===_0x189285(0xf2)?(shots[_0x5c2c48][_0x218592][_0x5b174d]=_0x189285(0xc1),renderPlayBoards(),cellHit(_0x218592,_0x5b174d,_0x5c2c48),markShipIfDestroyed(_0x5c2c48,_0x218592,_0x5b174d),checkWin(_0x5c2c48)&&showWinner(currentTurn)):(shots[_0x5c2c48][_0x218592][_0x5b174d]='miss',renderPlayBoards(),currentTurn=_0x5c2c48,updateTurnText());};function onShoot(){const _0x33cbcf=_0x574988,_0x358c8f=currentTurn==='red'?_0x33cbcf(0xb9):_0x33cbcf(0xcb);if(this[_0x33cbcf(0x107)]['player']!==_0x358c8f)return;if(shots[_0x358c8f][this[_0x33cbcf(0x107)]['r']][this[_0x33cbcf(0x107)]['c']])return;const _0x3d7929=parseInt(this[_0x33cbcf(0x107)]['r']),_0x1e4dff=parseInt(this['dataset']['c']),_0x3783ce=boards[_0x358c8f][_0x3d7929][_0x1e4dff]===_0x33cbcf(0xf2);shootBullet(this);}function cellHit(_0x32348e,_0x5b9161,_0x40a60e){const _0x157192=_0x574988,_0x104dca=elem(_0x40a60e+_0x157192(0x10a)),_0x5c2f6e=_0x104dca[_0x157192(0xc8)][_0x32348e*COLS+_0x5b9161];_0x5c2f6e['classList']['add']('fire-hit'),setTimeout(()=>_0x5c2f6e[_0x157192(0x10d)][_0x157192(0xd9)]('fire-hit'),0x384);}function checkWin(_0x4556f3){const _0x3a9197=_0x574988;for(let _0x46cc53=0x0;_0x46cc53<ROWS;_0x46cc53++)for(let _0x43f312=0x0;_0x43f312<COLS;_0x43f312++)if(boards[_0x4556f3][_0x46cc53][_0x43f312]===_0x3a9197(0xf2)&&!shots[_0x4556f3][_0x46cc53][_0x43f312])return![];return!![];}function markShipIfDestroyed(_0x53f344,_0x430b63,_0x29de61){const _0xa7a473=_0x574988,_0x47b729=playerShips[_0x53f344][_0xa7a473(0xa3)](_0x8e7e1a=>_0x8e7e1a[_0xa7a473(0x108)](_0x19d88b=>_0x19d88b['r']===_0x430b63&&_0x19d88b['c']===_0x29de61));if(!_0x47b729)return;const _0x127bc0=_0x47b729[_0xa7a473(0x109)](_0x31431d=>shots[_0x53f344][_0x31431d['r']][_0x31431d['c']]===_0xa7a473(0xc1));if(!_0x127bc0)return;const _0x120a05=elem(_0x53f344+'Board');_0x47b729['forEach'](_0x53b831=>{const _0x48df7b=_0xa7a473,_0x4f972c=_0x120a05[_0x48df7b(0xc8)][_0x53b831['r']*COLS+_0x53b831['c']];_0x4f972c[_0x48df7b(0x10d)][_0x48df7b(0x10b)](_0x48df7b(0xcc));});const _0x2c72d3=elem(_0xa7a473(0xf6));_0x2c72d3[_0xa7a473(0x10d)][_0xa7a473(0x10b)](_0xa7a473(0xae)),setTimeout(()=>_0x2c72d3[_0xa7a473(0x10d)]['remove']('shake'),0x190);}function renderPlayBoards(){const _0x57b5fe=_0x574988;[_0x57b5fe(0xcb),_0x57b5fe(0xb9)][_0x57b5fe(0xc9)](_0x5b807a=>{const _0x5b61d7=_0x57b5fe,_0x16dfa7=elem(_0x5b807a+_0x5b61d7(0x10a));for(let _0x26d47b=0x0;_0x26d47b<ROWS;_0x26d47b++){for(let _0x9427e9=0x0;_0x9427e9<COLS;_0x9427e9++){const _0x2d2d4e=_0x26d47b*COLS+_0x9427e9,_0x117f64=_0x16dfa7['children'][_0x2d2d4e];if(_0x117f64[_0x5b61d7(0x10d)][_0x5b61d7(0xd3)](_0x5b61d7(0xcc))){_0x117f64[_0x5b61d7(0xc0)]='cell\x20ship-dead-purple';continue;}_0x117f64[_0x5b61d7(0xc0)]=_0x5b61d7(0xba),_0x117f64['textContent']='';if(shots[_0x5b807a][_0x26d47b][_0x9427e9]===_0x5b61d7(0xc1))_0x117f64['classList'][_0x5b61d7(0x10b)](_0x5b61d7(0xc1));else shots[_0x5b807a][_0x26d47b][_0x9427e9]==='miss'&&(_0x117f64[_0x5b61d7(0x10d)]['add'](_0x5b61d7(0xcd)),_0x117f64[_0x5b61d7(0xab)]='X');}}});}function resetPlacement(){boards[placingPlayer]=emptyBoard(),draggingShipSize=null,buildPalette(),renderPlaceBoard();}function restartGame(){const _0x24fa87=_0x574988;placingPlayer='red',currentTurn='red',rotateDir='h',boards={'red':emptyBoard(),'blue':emptyBoard()},shots={'red':emptyBoard(),'blue':emptyBoard()},draggingShipSize=null,elem('placeArea')[_0x24fa87(0x10d)][_0x24fa87(0xd9)](_0x24fa87(0xeb)),elem(_0x24fa87(0xf6))[_0x24fa87(0x10d)][_0x24fa87(0x10b)](_0x24fa87(0xeb)),elem(_0x24fa87(0x103))['innerHTML']=_0x24fa87(0xf7),buildPalette(),renderPlaceBoard();}function showWinner(_0x16b05c){const _0x703084=_0x574988;elem(_0x703084(0xa4))[_0x703084(0xab)]=_0x16b05c[_0x703084(0xf3)]()+_0x703084(0xc7),elem(_0x703084(0xb3))[_0x703084(0xa0)]['display']=_0x703084(0xbb),winSound[_0x703084(0x100)]=0x0,winSound[_0x703084(0xb5)]();}function confirmWinner(){const _0x751f4f=_0x574988;elem('winnerOverlay')[_0x751f4f(0xa0)]['display']=_0x751f4f(0xdf),restartGame();}function hideHelpBtnFunction(){const _0x14acac=_0x574988;document[_0x14acac(0xd7)](_0x14acac(0xc2))[_0x14acac(0xa0)]['display']=_0x14acac(0xdf),document['getElementById'](_0x14acac(0xe8))[_0x14acac(0xa0)]['display']=_0x14acac(0xdf);}function showHelp(){const _0x3fceaf=_0x574988;document[_0x3fceaf(0xd7)](_0x3fceaf(0xc4))['style'][_0x3fceaf(0xa8)]=_0x3fceaf(0xbb);const _0x3c8e7b=document[_0x3fceaf(0xd7)]('helpVideo');_0x3c8e7b[_0x3fceaf(0x100)]=0x0,_0x3c8e7b[_0x3fceaf(0xb5)]();}function closeHelp(){const _0x5e2f3c=_0x574988;document[_0x5e2f3c(0xd7)](_0x5e2f3c(0xc4))[_0x5e2f3c(0xa0)][_0x5e2f3c(0xa8)]=_0x5e2f3c(0xdf),document[_0x5e2f3c(0xd7)](_0x5e2f3c(0xb1))['pause']();}
</script>
</body>
</html>
