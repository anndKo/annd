<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý chi tiêu</title>

    <style>
        body { font-family: Arial; margin:0; padding:0; background: linear-gradient(120deg,#ffecd2,#fcb69f);}
        .header {background: rgba(0,0,0,0.75); color:white; padding:15px 20px; display:flex; justify-content:space-between; align-items:center;}
        .logout {background:#ff4444;padding:7px 15px;color:white;border:none;border-radius:5px;cursor:pointer;}
        h2{text-align:center;margin-top:15px;}
        .calendar{text-align:center;margin-top:10px;}
        .overlay, .range-overlay {position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6); display:none; justify-content:center; align-items:center;}
        .form-box {background:white;padding:20px; width:330px; border-radius:10px;}
        input {width:100%; padding:7px; margin-top:5px; margin-bottom:12px;}
        #records {background:white; width:90%; margin:auto; margin-top:20px; padding:15px; border-radius:10px;}
        table {width:100%; border-collapse:collapse;}
        th, td {border:1px solid #ccc; padding:8px; text-align:center;}
        .action-btn {margin:0 3px; padding:3px 8px; border:none; border-radius:5px; cursor:pointer;}
        .edit-btn{background:#ffc107; color:black;}
        .delete-btn{background:#dc3545;color:white;}
        button {cursor:pointer;}
        .tong-tien {
    color: #e74c3c; /* màu đỏ nổi bật, bạn có thể đổi thành màu khác */
    font-weight: bold;
}
#helpBtn {
    position: fixed;
    top: 15px;
    right: 15px;
    padding: 10px 18px;
    background: #ff9800;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    z-index: 11000;
}

#hideHelpBtn {
    position: fixed;
    top: 15px;
    right: 130px;
    padding: 10px 18px;
    background: #ca2222;
    color:white;
    border:none;
    border-radius:8px;
    font-size:16px;
    cursor:pointer;
    z-index:11000;
    font-weight: 600;
}

#helpOverlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.8);
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 12000;
}
#helpOverlay video {
    max-width: 90%;
    max-height: 80%;
    border-radius: 12px;
}
#closeHelp {
    margin-top: 20px;
    padding: 12px 20px;
    background: #e53935;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 18px;
    cursor: pointer;
}

    </style>
</head>
<body>
    <!-- NÚT ẨN DUY NHẤT -->
<button id="hideHelpBtn" onclick="hideHelpBtnFunction()">X</button>

<!-- NÚT HƯỚNG DẪN -->
<button id="helpBtn" onclick="showHelp()">Hướng dẫn</button>

<!-- OVERLAY VIDEO -->
<div id="helpOverlay">
    <video id="helpVideo" controls>
        <source src="quản lí chi tiêu.mp4" type="video/mp4">
    </video>
    <button id="closeHelp" onclick="closeHelp()">Đóng</button>
</div>

<div class="header">
    <div>Xin chào, <span id="ten_user"></span></div>
    <button class="logout" onclick="dangXuat()">Đăng xuất</button>
</div>
<div style="width: 40px; background-color: #061a07; padding: 10px;border-radius: 8px;" ><a href="trangchu.html" ><img src="ngoinha.jpg" alt="" width="100%" style="border-radius: 10px;"></a> <br><a href="tienichmorong.html" ><img src="muiten.jpg" alt="" width="100%" style="border-radius: 10px; margin-top: 20px;"></a></div>
<h2>Quản Lý Chi Tiêu</h2>

<div class="calendar">
    <label>Chọn ngày:</label>
    <input type="date" id="datePicker" style="width: 70%;">
    <button onclick="openForm()" style="background:#58cea6;color:black;padding:8px 12px;border-radius:5px;font-weight:600;font-size:20px;">Thêm</button>
</div>

<!-- Form Thêm/Sửa -->
<div class="overlay" id="overlay">
    <div class="form-box">
        <h3>Thêm / Sửa Chi Tiêu</h3>
        <label id="label_sp">Tên sản phẩm</label>
        <input type="text" id="sp">
        <label id="label_gia" style="display:none;">Giá</label>
        <input type="number" id="gia" style="display:none;">
        <label id="label_sl" style="display:none;">Số lượng</label>
        <input type="number" id="soluong" style="display:none;">
        <button onclick="addExpense()" style="padding:7px 15px;">Xác nhận</button>
        <button onclick="closeForm()" style="background:red;color:white;padding:7px 15px;">Đóng</button>
    </div>
</div>

<!-- Form Khoảng Ngày -->
<div class="range-overlay" id="rangeOverlay">
    <div class="form-box">
        <h3>Xem tổng chi tiêu</h3>
        <label>Ngày bắt đầu</label>
        <input type="date" id="startDate">
        <label>Ngày kết thúc</label>
        <input type="date" id="endDate">
        <button onclick="showRangeTotal()" style="padding:7px 15px;">Xác nhận</button>
        <button onclick="closeRangeForm()" style="background:red;color:white;padding:7px 15px;">Đóng</button>
    </div>
</div>

<div id="records">
    <h3>Chi tiêu trong ngày</h3>
    <table>
        <thead>
            <tr>
                <th>Sản phẩm</th>
                <th>Giá</th>
                <th>Số lượng</th>
                <th>Tổng</th>
                <th>Hành động</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
    <h3 style="text-align:right;margin-top:10px;">Tổng: <span id="tong">0</span> VNĐ</h3>

    <button onclick="showLast30Days()" style="margin-top:10px;background:#007bff;color:white;padding:8px 15px;border:none;border-radius:5px;">Xem 30 ngày gần nhất</button>
    <button onclick="openRangeForm()" style="margin-top:10px;background:#28a745;color:white;padding:8px 15px;border:none;border-radius:5px;">Xem tổng theo khoảng</button>
</div>

<script>
    function _0x2a52(_0x21ec50,_0x1c834d){const _0x370eac=_0x370e();return _0x2a52=function(_0x2a5243,_0xadf4f0){_0x2a5243=_0x2a5243-0xae;let _0x22d887=_0x370eac[_0x2a5243];return _0x22d887;},_0x2a52(_0x21ec50,_0x1c834d);}const _0x37decc=_0x2a52;function _0x370e(){const _0x14c09b=['onclick','Vui\x20lòng\x20nhập\x20link!','value','src','min','currentTime','305506ArwUxC','82737AsCjQz','style','Annd.png','450300uVoLoZ','urlInput','click','toDataURL','open','download','getElementById','201486abXkNp','image/png','none','16KnMluw','createElement','112844fDPrOL','qrCanvas','398928CeSvHf','helpVideo','trim','drawImage','helpOverlay','inline-block','width','clearRect','getContext','nenqr.jpg','canvas','height','_blank','display','error','https://drive.google.com','onload','5cAtqym','hideHelpBtn','2113867UsnVRE','flex'];_0x370e=function(){return _0x14c09b;};return _0x370e();}(function(_0x22fa88,_0x2b81cf){const _0xc21263=_0x2a52,_0x10e304=_0x22fa88();while(!![]){try{const _0x3e4fb8=-parseInt(_0xc21263(0xd7))/0x1+parseInt(_0xc21263(0xbc))/0x2+parseInt(_0xc21263(0xae))/0x3+-parseInt(_0xc21263(0xba))/0x4+parseInt(_0xc21263(0xcd))/0x5*(-parseInt(_0xc21263(0xb5))/0x6)+parseInt(_0xc21263(0xcf))/0x7+parseInt(_0xc21263(0xb8))/0x8*(-parseInt(_0xc21263(0xd8))/0x9);if(_0x3e4fb8===_0x2b81cf)break;else _0x10e304['push'](_0x10e304['shift']());}catch(_0x23cfcf){_0x10e304['push'](_0x10e304['shift']());}}}(_0x370e,0x40e85));function showHelp(){const _0x89e086=_0x2a52;document[_0x89e086(0xb4)](_0x89e086(0xc0))[_0x89e086(0xd9)][_0x89e086(0xc9)]=_0x89e086(0xd0);const _0x379289=document[_0x89e086(0xb4)](_0x89e086(0xbd));_0x379289[_0x89e086(0xd6)]=0x0,_0x379289['play']();}function closeHelp(){const _0x6c47be=_0x2a52;document[_0x6c47be(0xb4)](_0x6c47be(0xc0))['style'][_0x6c47be(0xc9)]=_0x6c47be(0xb7),document[_0x6c47be(0xb4)](_0x6c47be(0xbd))['pause']();}function hideHelpBtnFunction(){const _0x4b2d00=_0x2a52;document[_0x4b2d00(0xb4)]('helpBtn')[_0x4b2d00(0xd9)][_0x4b2d00(0xc9)]=_0x4b2d00(0xb7),document[_0x4b2d00(0xb4)](_0x4b2d00(0xce))[_0x4b2d00(0xd9)][_0x4b2d00(0xc9)]=_0x4b2d00(0xb7);}const canvas=document[_0x37decc(0xb4)](_0x37decc(0xbb)),ctx=canvas[_0x37decc(0xc4)]('2d'),downloadBtn=document['getElementById'](_0x37decc(0xb3)),openDriveBtn=document[_0x37decc(0xb4)]('openDrive'),background=new Image();background[_0x37decc(0xd4)]=_0x37decc(0xc5),document[_0x37decc(0xb4)]('generate')['onclick']=async()=>{const _0x302f67=_0x37decc,_0x186816=document[_0x302f67(0xb4)](_0x302f67(0xaf))[_0x302f67(0xd3)][_0x302f67(0xbe)]();if(!_0x186816){alert(_0x302f67(0xd2));return;}try{const _0x53fb3d=await QRCode[_0x302f67(0xb1)](_0x186816,{'width':0xb4}),_0x1011a1=new Image();_0x1011a1['src']=_0x53fb3d,_0x1011a1[_0x302f67(0xcc)]=()=>{const _0x116df0=_0x302f67;ctx[_0x116df0(0xc3)](0x0,0x0,canvas[_0x116df0(0xc2)],canvas['height']);const _0x1118a5=Math[_0x116df0(0xd5)](canvas[_0x116df0(0xc2)]/background[_0x116df0(0xc2)],canvas[_0x116df0(0xc7)]/background[_0x116df0(0xc7)]),_0x4cb2f=background[_0x116df0(0xc2)]*_0x1118a5,_0x112ffd=background[_0x116df0(0xc7)]*_0x1118a5,_0x393a2c=(canvas[_0x116df0(0xc2)]-_0x4cb2f)/0x2,_0x2abf6c=(canvas[_0x116df0(0xc7)]-_0x112ffd)/0x2;ctx['drawImage'](background,_0x393a2c,_0x2abf6c,_0x4cb2f,_0x112ffd);const _0x387b84=0xb4,_0x393b4f=(canvas[_0x116df0(0xc2)]-_0x387b84)/0x2,_0xe93ada=(canvas['height']-_0x387b84)/0x2;ctx[_0x116df0(0xbf)](_0x1011a1,_0x393b4f,_0xe93ada,_0x387b84,_0x387b84),downloadBtn['style'][_0x116df0(0xc9)]=_0x116df0(0xc1),downloadBtn[_0x116df0(0xd1)]=()=>{const _0x1041c5=_0x116df0,_0x164a1b=document['createElement'](_0x1041c5(0xc6)),_0x243b2b=0x3e8;_0x164a1b[_0x1041c5(0xc2)]=_0x243b2b,_0x164a1b[_0x1041c5(0xc7)]=_0x243b2b;const _0x191c90=_0x164a1b[_0x1041c5(0xc4)]('2d'),_0x536c6b=Math[_0x1041c5(0xd5)](_0x243b2b/background[_0x1041c5(0xc2)],_0x243b2b/background['height']),_0x486fea=background['width']*_0x536c6b,_0x1d9f24=background[_0x1041c5(0xc7)]*_0x536c6b,_0x2f763a=(_0x243b2b-_0x486fea)/0x2,_0x51552c=(_0x243b2b-_0x1d9f24)/0x2;_0x191c90[_0x1041c5(0xbf)](background,_0x2f763a,_0x51552c,_0x486fea,_0x1d9f24);const _0x4a2df0=0xb4/0xfa*_0x243b2b,_0x255be4=(_0x243b2b-_0x4a2df0)/0x2,_0xac0ede=(_0x243b2b-_0x4a2df0)/0x2;_0x191c90['drawImage'](_0x1011a1,_0x255be4,_0xac0ede,_0x4a2df0,_0x4a2df0);const _0xff1435=document[_0x1041c5(0xb9)]('a');_0xff1435[_0x1041c5(0xb3)]=_0x1041c5(0xda),_0xff1435['href']=_0x164a1b['toDataURL'](_0x1041c5(0xb6)),_0xff1435[_0x1041c5(0xb0)]();};};}catch(_0x5c673b){console[_0x302f67(0xca)](_0x5c673b),alert('Có\x20lỗi\x20khi\x20tạo\x20QR\x20Code.');}},downloadBtn[_0x37decc(0xd1)]=()=>{const _0x3efa95=_0x37decc,_0x5ebb98=document[_0x3efa95(0xb9)]('a');_0x5ebb98[_0x3efa95(0xb3)]='qr_with_bg.png',_0x5ebb98['href']=canvas[_0x3efa95(0xb1)](_0x3efa95(0xb6)),_0x5ebb98['click']();},openDriveBtn[_0x37decc(0xd1)]=()=>{const _0x37b569=_0x37decc;window[_0x37b569(0xb2)](_0x37b569(0xcb),_0x37b569(0xc8));};

</script>

</body>
</html>
